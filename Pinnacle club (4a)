#include <iostream>
#include <string>
using namespace std;

struct node
{
    int PRN;
    string Name;
    node *next;
};

class Club
{
public:
    node *head, *tail;

    Club()
    {
        head = tail = NULL;
    }

    void create();     
    void display();   
    void insert();     
    void count();     
};

void Club::create()
{
    cout << "Welcome to Pinnacle Club!!!" << endl;

    char ch;
    do
    {
        node *nnode = new node;
        nnode->next = NULL;

        cout << "\nEnter PRN of user: ";
        cin >> nnode->PRN;

        cout << "Enter Name of user: ";
        cin >> nnode->Name;

        if (head == NULL)     
        {
            head = tail = nnode;
        }
        else               
        {
            tail->next = nnode;
            tail = nnode;
        }

        cout << "\nAdd more members? (y/n): ";
        cin >> ch;

    } while (ch == 'y' || ch == 'Y');
}

void Club::display()
{
    if (head == NULL)
    {
        cout << "\nClub member list is empty.\n";
        return;
    }

    node *temp = head;
    cout << "\nPRN\tName" << endl;
    while (temp != NULL)
    {
        cout << temp->PRN << "\t" << temp->Name << endl;
        temp = temp->next;
    }
}

void Club::insert()
{
    int choice;
    cout << "\nInsertion Menu:\n";
    cout << "1. Insert President (at beginning)\n";
    cout << "2. Insert Secretary (at end)\n";
    cout << "3. Insert Member (in between)\n";
    cout << "Enter choice: ";
    cin >> choice;

    node *nnode = new node;
    cout << "Enter PRN: ";
    cin >> nnode->PRN;
    cout << "Enter Name: ";
    cin >> nnode->Name;
    nnode->next = NULL;

    if (choice == 1)            
    {
        nnode->next = head;
        head = nnode;
        if (tail == NULL)
            tail = nnode;
    }
    else if (choice == 2)       // Insert as Secretary
    {
        tail->next = nnode;
        tail = nnode;
    }
    else if (choice == 3)       // Insert as Member
    {
        int key;
        cout << "Insert after PRN: ";
        cin >> key;

        node *temp = head;
        while (temp != NULL && temp->PRN != key)
            temp = temp->next;

        if (temp == NULL)
        {
            cout << "PRN NOT FOUND!" << endl;
            return;
        }

        nnode->next = temp->next;
        temp->next = nnode;
    }
}

void Club::count()
{
    int cnt = 0;
    node *temp = head;

    while (temp != NULL)
    {
        cnt++;
        temp = temp->next;
    }

    cout << "\nTotal members in Pinnacle Club = " << cnt << endl;
}

int main()
{
    Club club;
    club.create();     
    club.display();
    club.count();

    char ch;
    do
    {
        cout << "\nDo you want to insert any member? (y/n): ";
        cin >> ch;

        if (ch == 'y' || ch == 'Y')
        {
            club.insert();
            club.display();
            club.count();
        }

    } while (ch == 'y' || ch == 'Y');

    return 0;
}
